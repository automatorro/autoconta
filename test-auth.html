<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Autentificare Supabase</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .step {
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #007bff;
            background-color: #f8f9fa;
        }
        .warning {
            border-left-color: #ffc107;
            background-color: #fff3cd;
        }
        .success {
            border-left-color: #28a745;
            background-color: #d4edda;
        }
        .error {
            border-left-color: #dc3545;
            background-color: #f8d7da;
        }
        code {
            background-color: #e9ecef;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: monospace;
        }
        .log-example {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        .button {
            display: inline-block;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 10px 5px;
        }
        .button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Ghid de Testare Autentificare Supabase</h1>
        
        <div class="step">
            <h3>ğŸ“‹ Pasul 1: PregÄƒtire pentru Testare</h3>
            <p>Ãnainte de a Ã®ncepe testarea, asigurÄƒ-te cÄƒ:</p>
            <ul>
                <li>Serverul ruleazÄƒ pe <code>http://localhost:8080</code></li>
                <li>Consola browser-ului este deschisÄƒ (F12)</li>
                <li>EÈ™ti pe pagina de autentificare</li>
            </ul>
            <a href="http://localhost:8080/auth" class="button" target="_blank">Deschide Pagina de Autentificare</a>
        </div>

        <div class="step warning">
            <h3>âš ï¸ Pasul 2: Verificare Log-uri IniÈ›iale</h3>
            <p>Ãn consola browser-ului, ar trebui sÄƒ vezi log-uri similare cu:</p>
            <div class="log-example">
ğŸ” Checking existing session: null<br>
ğŸ”„ Loading user data for userId: [user-id]<br>
âŒ Table access error: {message: TypeError: Failed to fetch...}
            </div>
            <p><strong>Nota:</strong> Eroarea "Failed to fetch" indicÄƒ problema cu configuraÈ›ia Supabase.</p>
        </div>

        <div class="step">
            <h3>ğŸ§ª Pasul 3: Testare Autentificare Email</h3>
            <p>Pentru a testa autentificarea cu email:</p>
            <ol>
                <li>Introdu un email valid Ã®n formularul de login</li>
                <li>Introdu o parolÄƒ</li>
                <li>ApasÄƒ "Autentificare"</li>
                <li>UrmÄƒreÈ™te log-urile Ã®n consolÄƒ</li>
            </ol>
            
            <h4>Log-uri AÈ™teptate pentru Succes:</h4>
            <div class="log-example">
ğŸ” Starting email/password sign in for: test@example.com<br>
ğŸ” Sign in result - Data: {...} Error: null<br>
âœ… Sign in successful<br>
ğŸ” Auth state change: SIGNED_IN User: test@example.com
            </div>

            <h4>Log-uri AÈ™teptate pentru Eroare:</h4>
            <div class="log-example">
ğŸ” Starting email/password sign in for: test@example.com<br>
âŒ Sign in failed: Invalid login credentials Status: 400<br>
ğŸ” Sign in result - Error: {...}
            </div>
        </div>

        <div class="step">
            <h3>ğŸ”— Pasul 4: Testare Autentificare Google</h3>
            <p>Pentru a testa autentificarea cu Google:</p>
            <ol>
                <li>ApasÄƒ butonul "ContinuÄƒ cu Google"</li>
                <li>UrmÄƒreÈ™te log-urile Ã®n consolÄƒ ÃNAINTE de redirect</li>
            </ol>
            
            <h4>Log-uri AÈ™teptate:</h4>
            <div class="log-example">
ğŸ”— Google OAuth redirect URL: http://localhost:8080/<br>
ğŸŒ Current origin: http://localhost:8080<br>
ğŸŒ Environment detection - isProduction: false isLocalhost: true<br>
ğŸ§ª Running in local development environment on port 8080<br>
ğŸ”— Starting Google OAuth with redirectTo: http://localhost:8080/<br>
âœ… Google OAuth initiated successfully, redirecting...
            </div>

            <h4>Erori Comune:</h4>
            <div class="log-example error">
âŒ Google OAuth error: Invalid redirect URL Status: 400<br>
âŒ Full error object: {...}
            </div>
        </div>

        <div class="step error">
            <h3>ğŸš¨ Pasul 5: Identificare Probleme</h3>
            
            <h4>ProblemÄƒ: "Invalid redirect URL"</h4>
            <p><strong>Cauza:</strong> URL-urile de redirect nu sunt configurate corect Ã®n Supabase Dashboard</p>
            <p><strong>SoluÈ›ia:</strong> AdaugÄƒ <code>http://localhost:8080/</code> Ã®n Redirect URLs</p>

            <h4>ProblemÄƒ: "OAuth provider not configured"</h4>
            <p><strong>Cauza:</strong> Google OAuth nu este configurat Ã®n Supabase</p>
            <p><strong>SoluÈ›ia:</strong> ConfigureazÄƒ Google OAuth Ã®n Supabase Dashboard</p>

            <h4>ProblemÄƒ: "Failed to fetch"</h4>
            <p><strong>Cauza:</strong> Probleme de conectivitate sau configuraÈ›ie incorectÄƒ</p>
            <p><strong>SoluÈ›ia:</strong> VerificÄƒ URL-ul Supabase È™i cheile API</p>
        </div>

        <div class="step success">
            <h3>âœ… Pasul 6: Verificare ConfiguraÈ›ii</h3>
            <p>DacÄƒ Ã®ntÃ¢mpini probleme, verificÄƒ configuraÈ›iile Ã®n:</p>
            
            <h4>Supabase Dashboard:</h4>
            <ul>
                <li><strong>Site URL:</strong> <code>http://localhost:8080</code></li>
                <li><strong>Redirect URLs:</strong> <code>http://localhost:8080/</code></li>
            </ul>

            <h4>Google Cloud Console:</h4>
            <ul>
                <li><strong>JavaScript Origins:</strong> <code>http://localhost:8080</code></li>
                <li><strong>Redirect URIs:</strong> <code>https://ytjdvoyyiapkyzjrjllp.supabase.co/auth/v1/callback</code></li>
            </ul>
        </div>

        <div class="step">
            <h3>ğŸ§¹ Pasul 7: CurÄƒÈ›are Cache</h3>
            <p>DacÄƒ problemele persistÄƒ, Ã®ncearcÄƒ:</p>
            <ol>
                <li>Deschide Developer Tools (F12)</li>
                <li>Mergi la <strong>Application > Storage</strong></li>
                <li>È˜terge toate datele pentru <code>localhost:8080</code></li>
                <li>ReÃ®ncarcÄƒ pagina (Ctrl+F5)</li>
                <li>TesteazÄƒ Ã®n modul incognito</li>
            </ol>
        </div>

        <div class="step">
            <h3>ğŸ“ Suport</h3>
            <p>Pentru suport suplimentar, consultÄƒ:</p>
            <ul>
                <li><a href="./SUPABASE_AUTH_CONFIG.md" target="_blank">Ghidul Complet de Configurare</a></li>
                <li><a href="https://supabase.com/docs/guides/auth" target="_blank">DocumentaÈ›ia Supabase Auth</a></li>
                <li>Log-urile din consola browser-ului pentru detalii specifice</li>
            </ul>
        </div>
    </div>

    <script>
        // AfiÈ™eazÄƒ informaÈ›ii despre mediul curent
        console.log('ğŸŒ Test Environment Info:');
        console.log('Current URL:', window.location.href);
        console.log('Hostname:', window.location.hostname);
        console.log('Port:', window.location.port);
        console.log('Origin:', window.location.origin);
        console.log('Is localhost:', window.location.hostname === 'localhost');
        console.log('Expected Supabase redirect:', 'http://localhost:8080/');
    </script>
</body>
</html>